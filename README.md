# Jaris

Jaris is a project for a 8 bit computer called Aleph 0,
the repo contains all the software to simulate it, to compile code for it and the code that it would run.

## Files

### `src/` directory

It contains the source code for simulation, compilation and other things:

- `assemble.{c,h}`: contain the functions to compile files from assembly to OBJ.
- `files.{c,h}`: contain all the functions to encode/decode files, inspect them and interact with them.
- `instructions.{c,h}`: contain all the function and definitions for instructions and bytecode.
- `link.{c,h}`: contain the function to links OBJ files into EXE, SO or plain code.
- `runtime.{c,h}`: contain the functions and definitions to simulate the runtime of the computer.
- `sim.c`: provides a CLI for `runtime` and the `--test` option that runs a full test of the computer programs .
- `assembler.c`: provides a CLI to `assemble`.
- `linker.c`: provides a CLI to `link`.
- `inspect.c`: provides a CLI to inspect files (and disassemble the code).
- `code_analyzer.c`: creates a graph of the execution of the input file and uses it to perform checks (to the stack pointer for example).
- `encodefont.c`: creates a font file writing it byte by byte.

### `asm/` directory

It contains the assembly code for the bootloader, os, standard library and other programs:

Standard library:

The standard library (stdlib) is a SO file (dynamic library) that provides functions that can be used by any program linking with it at runtime reducing size of executables.

- `alloc.asm`: to allocate dynamically blocks of memory
- `dynamic_array.asm`: for dynamic arrays (using alloc)
- `execute.asm`: load and run a executable in a sub-process
- `exit.asm`: exit and return to parent process
- `get_char.asm`: reads the scan code form the keyboard and returns the ascii char
- `math.asm`: contains math functions
- `open_file.asm`: find and open a file
- `print.asm`: prints char to the GPU and stdout redirect
- `read_file.asm`: read from file
- `solve_path.asm`: gets the sector of the file or directory of the path
- `string.asm`: functions on strings
- `write_file.asm`: write to file

Programs:

- `bootloader.asm`: loads the os and the stdlib and runs the os.
- `os.asm + load_font.asm`: sets the os struct and process' structs, loads the font in GPU and runs sh.
- `sh.asm`: read line and search for a program to run.
- `test_font.asm`: it prints all the chars to test how the font looks like.
- `cat.asm`: prints the content of the input file.
- `cd.asm`: changes the directory.
- `echo.asm`: echoes the input in the command line.
- `ls.asm`: list files in a dir.
- `shutdown.asm`: halt the computer.
- `stack.asm`: a stack based programming language, compiles the input file to `/stack.out`.
- `bfjit.asm`: a jit compiler for brainfuck.

### `docs/` directory

It contains the documentation:

[Typst](https://typst.app/) is needed to compile the pdfs for the documentation.

- `README.md`: the old documentation, it's for file specification and structures used in the os etc.
- `aleph.typ`: the main documentation, with info about the hardware and also info about the os and the software of the computer.
- `aleph_images/` + `aleph_images.roff` + `aleph_images.pl`: perl compile roff PIC diagrams in separate png files for the documentation.
- `stdlibdoc.typ`: autogenerated documentation for the standard library (it takes the comment from the source code).
